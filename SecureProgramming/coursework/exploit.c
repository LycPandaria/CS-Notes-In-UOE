#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <openssl/md5.h>
/* gcc -g -lssl -lcrypto test.c -o test */
/* 	0x6257e639	0xd2ed0f31	0xcfea86a4	0xacda001e*/
/* 06crN */
/* echo -ne "\x30\x36\x63\x72\x4e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x39\xe6\x57\x62\x31\x0f\xed\xd2\xa4\x86\xea\xcf\x1e" */

char correct[3] = {0x00,0xda,0xac};

void next(char s[])
{
    int i,j;
    for (i=0,j=4; i < 5 && j >= 0; i ++)
    {
      if (s[j] != 0x7A)
      {
        s[j] ++;
        break;
      }
      else
      {
        s[j] = 0x30;
        j--;
        continue;
      }
    }
}

int main()
{
    char pwd[6] = {0x30,0x30,0x30,0x30,0x30,0x00};
    char end[6] = {0x7A,0x7A,0x7A,0x7A,0x7A,0x00};
    char hash[16] = ""; 
    char shellcode[30] = "";
    int i;   
   
    while(1)
    {
        next(pwd);
	MD5(pwd, strlen(pwd), hash);
	
        if(memcmp(hash+13*sizeof(char),correct,3)==0)
	    break;
        if(strcmp(pwd, end) == 0)
        {
            printf("Cant find!\n");
            break;
        }
    }

    // build shellcode
    for(i=0; i<5; i++)
	shellcode[i] = pwd[i];
    for(i=5;i<16;i++)
      shellcode[i]=0x00;
    for(i=16;i<30;i++)
      shellcode[i]=hash[i-16];
//printf("%s",shellcode);
for(i=0;i<30;i++)
  printf("%c", shellcode[i]);
    return 0;
}
